import{_ as f,c as n,a as i,F as l,r as g,f as m,t as h,b as _,v,g as I,o as a,n as p}from"./index-7Mb5DR7o.js";const C={name:"ChatView",data(){return{groups:[],friends:[],chats:{},currentGroupId:null,currentFriendId:null,newMessage:""}},created(){this.loadData(),this.groups.length>0&&(this.currentGroupId=this.groups[0].id)},computed:{currentGroup(){return this.groups.find(e=>e.id===this.currentGroupId)},friendsInCurrentGroup(){return this.friends.filter(e=>e.groupId===this.currentGroupId)},currentFriend(){return this.friends.find(e=>e.id===this.currentFriendId)},currentChat(){return this.chats[this.currentFriendId]||{messages:[]}}},methods:{loadData(){const e=JSON.parse(localStorage.getItem("groups")),t=JSON.parse(localStorage.getItem("friends"));e&&t?(this.groups=e,this.friends=t):(this.groups=[{id:1,name:"Family"},{id:2,name:"Work"}],this.friends=[{id:1,name:"Alice",groupId:1,isBestFriend:!0},{id:2,name:"Bob",groupId:2,isBestFriend:!1},{id:3,name:"Charlie",groupId:1,isBestFriend:!1}]);const d=JSON.parse(localStorage.getItem("chats"));d?this.chats=d:this.friends.forEach(o=>{this.chats[o.id]={messages:[{sender:"bot",text:`Start chatting with ${o.name}!`}]}})},saveChats(){localStorage.setItem("chats",JSON.stringify(this.chats))},selectGroup(e){this.currentGroupId=e,this.currentFriendId=null},selectChat(e){this.currentFriendId=e},sendMessage(){this.newMessage.trim()!==""&&(this.currentChat.messages.push({sender:"user",text:this.newMessage.trim()}),this.newMessage="",this.saveChats(),this.$nextTick(()=>{const e=this.$el.querySelector(".chat-history");e.scrollTop=e.scrollHeight}))}},watch:{friends(e){e.forEach(t=>{this.chats[t.id]||(this.chats[t.id]={messages:[{sender:"bot",text:`Start chatting with ${t.name}!`}]})}),Object.keys(this.chats).forEach(t=>{e.find(d=>d.id==t)||delete this.chats[t]}),this.saveChats()}}},y={class:"chat-view"},F={class:"group-sidebar"},k={class:"group-list"},S=["onClick"],w={key:0,class:"friend-sidebar"},G={class:"friend-list"},M=["onClick"],b={class:"chat-content"},x={class:"chat-header"},B={class:"chat-history"},N={key:0,class:"message-input"};function O(e,t,d,o,c,r){return a(),n("div",y,[i("div",F,[i("div",k,[(a(!0),n(l,null,g(c.groups,s=>(a(),n("div",{class:p(["group-card",{active:c.currentGroupId===s.id}]),key:s.id,onClick:u=>r.selectGroup(s.id)},[i("h3",null,h(s.name),1)],10,S))),128))])]),r.currentGroup?(a(),n("div",w,[i("div",G,[(a(!0),n(l,null,g(r.friendsInCurrentGroup,s=>(a(),n("div",{class:p(["friend-card",{active:c.currentFriendId===s.id}]),key:s.id,onClick:u=>r.selectChat(s.id)},[i("h4",null,h(s.name),1)],10,M))),128))])])):m("",!0),i("div",b,[i("div",x,[i("h2",null,h(r.currentFriend?r.currentFriend.name:"Select a friend to chat"),1)]),i("div",B,[(a(!0),n(l,null,g(r.currentChat.messages,(s,u)=>(a(),n("div",{key:u,class:p(["message",s.sender])},[i("p",null,h(s.text),1)],2))),128))]),r.currentFriend?(a(),n("div",N,[_(i("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>c.newMessage=s),placeholder:"Type your message...",onKeyup:t[1]||(t[1]=I((...s)=>r.sendMessage&&r.sendMessage(...s),["enter"]))},null,544),[[v,c.newMessage]]),i("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...s)=>r.sendMessage&&r.sendMessage(...s))},"Send")])):m("",!0)])])}const D=f(C,[["render",O],["__scopeId","data-v-5d2953e8"]]);export{D as default};
